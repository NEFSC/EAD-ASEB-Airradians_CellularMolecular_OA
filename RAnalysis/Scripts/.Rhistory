library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(multcompView)
library(agricolae)
library(Rmisc)
library(lmerTest)
library(pander)
library(performance)
library(Rmisc)
library(tidyr)
library(reshape2)
library(rcompanion)
library(kableExtra)
library(ggpubr)
library(tidyr)
library(nlme)
library(car)
library(rcompanion) # to run the Schrier -Ray-Hare non parametric 2 way
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_Reexposure_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
data  <-read.csv(file="Data/FlowCytometry/Hemolymph_data_raw.csv", header = TRUE)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(multcompView)
library(agricolae)
library(Rmisc)
library(lmerTest)
library(pander)
library(performance)
library(Rmisc)
library(tidyr)
library(reshape2)
library(rcompanion)
library(kableExtra)
library(ggpubr)
library(tidyr)
library(nlme)
library(car)
library(rcompanion) # to run the Schrier -Ray-Hare non parametric 2 way
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_Reexposure_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
data  <-read.csv(file="Data/FlowCytometry/Hemolymph_data_raw.csv", header = TRUE)
getwd()
getwd()
data  <-read.csv(file="../Data/FlowCytometry/Hemolymph_data_raw.csv", header = TRUE)
head(data)
Day1_PercLive_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::mutate(SYBR_PI_percent_alive = as.numeric(sub("%", "", SYBR_PI_percent_alive))) %>% # the % sign is included making this a character, omit the percent and make numeric!
dplyr::mutate(SYBR_PI_percent_alive = as.numeric(sub(",", "", SYBR_PI_percent_alive))) %>% # the % sign is included making this a character, omit the percent and make numeric!
na.omit()
Day1_PercLive_df
Day1_PercDead_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::mutate(SYBR_PI_percent_dead = as.numeric(sub("%", "", SYBR_PI_percent_dead))) %>% # the % sign is included making this a character, omit the percent and make numeric!
dplyr::mutate(SYBR_PI_percent_dead = as.numeric(sub(",", "", SYBR_PI_percent_dead))) %>% # the % sign is included making this a character, omit the percent and make numeric!
na.omit()
Day1_PercDead_df
Day1_PercLive_df
Day1_PercLive_AOV <- aov(lm(SYBR_PI_percent_alive ~ pCO2_history*pCO2_exposure, data=Day1_PercLive_df))
shapiro.test(resid(Day1_PercLive_AOV))
leveneTest(Day1_PercLive_AOV)
summary(Day1_PercLive_AOV)
#                             Df Sum Sq Mean Sq F value Pr(>F)
# pCO2_history                2  345.9  172.97   2.587 0.0896 . # marginal effect of pCO2 history
# pCO2_exposure               2  113.6   56.80   0.849 0.4363
# pCO2_history:pCO2_exposure  4  192.0   48.00   0.718 0.5855
# Residuals                  35 2340.5   66.87
TukeyHSD(Day1_PercLive_AOV)
Day1_PercDead_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>% # filter for desired date of rhte experiment
dplyr::mutate(SYBR_PI_percent_dead = as.numeric(sub("%", "", SYBR_PI_percent_dead))) %>% # the % sign is included making this a character, omit the percent and make numeric!
dplyr::mutate(SYBR_PI_percent_dead = as.numeric(sub(",", "", SYBR_PI_percent_dead))) %>% # the % sign is included making this a character, omit the percent and make numeric!
na.omit()
Day1_PercDead_df
Day1_PercDead_AOV <- aov(lm(SYBR_PI_percent_dead ~ pCO2_history*pCO2_exposure, data=Day1_PercDead_df))
shapiro.test(resid(Day1_PercDead_AOV)) # normal 0.7353
leveneTest(Day1_PercLive_AOV) # 0.162 PASS variance test
leveneTest(Day1_PercDead_AOV) # 0.162 PASS variance test
Day1_PercDead_SRH <- scheirerRayHare(SYBR_PI_percent_dead ~ pCO2_history*pCO2_exposure, data=Day1_PercDead_df)
summary(Day1_PercDead_SRH)
Day1_PercDead_SRH
Day1_MitoSox_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502)
Day1_MitoSox_df
Day1_MitoSox_AOV <- aov(lm(MitoSoxGreen_Mean_FL1 ~ pCO2_history*pCO2_exposure, data=Day1_MitoSox_df))
shapiro.test(resid(Day1_MitoSox_AOV)) # normal 0.7353
leveneTest(Day1_MitoSox_AOV) # 0.162 PASS variance test
summary(Day1_MitoSox_AOV)
Day1_MitoMemPot_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502)
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_MitoMemPot_df))
data$JC10_FL2_FL1_Ratio <- ( (as.numeric(sub(",", "", data$JC10_FL2_Jaggregate))) /
(as.numeric(sub(",", "", data$JC10_FL1_monomer))) )
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_MitoMemPot_df))
Day1_MitoMemPot_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502)
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_MitoMemPot_df))
shapiro.test(resid(Day1_MitoMemPot_AOV)) # normal 0.2556
leveneTest(Day1_MitoMemPot_AOV) # 0.0716 . PASS variance test
Day1_MitoMemPot_SRH <- scheirerRayHare(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_MitoMemPot_df)
Day1_MitoMemPot_SRH
Day1_MitoMemPot_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>%
filter(pCO2_history %in% 'low')
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_history*pCO2_exposure, data=Day1_MitoMemPot_df))
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_exposure, data=Day1_MitoMemPot_df))
shapiro.test(resid(Day1_MitoMemPot_AOV)) # non normal 0.0001602
leveneTest(Day1_MitoMemPot_AOV) # 0.3957 PASS variance test
summary(Day1_MitoMemPot_AOV)
Day1_MitoMemPot_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>%
filter(pCO2_history %in% 'moderate')
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_exposure, data=Day1_MitoMemPot_df))
shapiro.test(resid(Day1_MitoMemPot_AOV)) # non normal 0.0001602
leveneTest(Day1_MitoMemPot_AOV) # 0.3957 PASS variance test
summary(Day1_MitoMemPot_AOV)
Day1_MitoMemPot_df <- data %>%
# edit data to suit out needs
dplyr::filter(Date %in% 20230502) %>%
filter(pCO2_history %in% 'severe')
Day1_MitoMemPot_AOV <- aov(lm(JC10_FL2_FL1_Ratio ~ pCO2_exposure, data=Day1_MitoMemPot_df))
shapiro.test(resid(Day1_MitoMemPot_AOV)) # non normal 0.0001602
leveneTest(Day1_MitoMemPot_AOV) # 0.3957 PASS variance test
summary(Day1_MitoMemPot_AOV)
