ellipse = TRUE,
circle = TRUE)+
#ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggbiplot(pca_res_D1_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggarrange(
ggbiplot(pca_res_D1_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, low history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1_MOD,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_MOD$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, mod history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
nrow=3)
ggarrange(
autoplot(pca_res_D1, data = Merge_master_OM_D1,
colour = 'pCO2_history',
loadings = TRUE,
loadings.label = TRUE, loadings.label.size = 3,
frame = TRUE)
#frame.type = 'norm')
,
autoplot(pca_res_D1, data = Merge_master_OM_D1,
colour = 'pCO2_exposure',
loadings = TRUE,
loadings.label = TRUE, loadings.label.size = 3,
frame = TRUE)
#frame.type = 'norm')
)
pca_res_D14_LOW         <- prcomp(data_normalized_D14_LOW, scale. = TRUE)
# normalize the data
# day 1 ------------------------------------------------------------------------------------------------ #
data_normalized_D1     <- scale(numerical_data_D1)
data_normalized_D1_LOW <- scale(numerical_data_D1_LOW)
data_normalized_D1_MOD <- scale(numerical_data_D1_MOD)
data_normalized_D1_SEV <- scale(numerical_data_D1_SEV)
# day 14 ------------------------------------------------------------------------------------------------ #
data_normalized_D14     <- scale(numerical_data_D14)
data_normalized_D14_LOW <- scale(numerical_data_D14_LOW)
data_normalized_D14_MOD <- scale(numerical_data_D14_MOD)
data_normalized_D14_SEV <- scale(numerical_data_D14_SEV)
# day 1 ------------------------------------------------------------------------------------------------ #
corr_matrix_D1     <- cor(data_normalized_D1)
ggcorrplot(corr_matrix_D1)
corr_matrix_D1_LOW <- cor(data_normalized_D1_LOW)
ggcorrplot(corr_matrix_D1_LOW)
corr_matrix_D1_MOD <- cor(data_normalized_D1_MOD)
ggcorrplot(corr_matrix_D1_MOD)
corr_matrix_D1_SEV <- cor(data_normalized_D1_SEV)
ggcorrplot(corr_matrix_D1_SEV)
# day 14 ------------------------------------------------------------------------------------------------ #
corr_matrix_D14     <- cor(data_normalized_D14)
ggcorrplot(corr_matrix_D14)
corr_matrix_D14_LOW <- cor(data_normalized_D14_LOW)
ggcorrplot(corr_matrix_D14_LOW)
corr_matrix_D14_MOD <- cor(data_normalized_D14_MOD)
ggcorrplot(corr_matrix_D14_MOD)
corr_matrix_D14_SEV <- cor(data_normalized_D14_SEV)
ggcorrplot(corr_matrix_D14_SEV)
pca_res_D14_LOW         <- prcomp(data_normalized_D14_LOW, scale. = TRUE)
Merge_master_OM_D14_LOW <- Merge_master_OM %>%
dplyr::filter(Day %in% 1 & pCO2_history == 'low')
pca_res_D14_MOD         <- prcomp(data_normalized_D14_MOD, scale. = TRUE)
Merge_master_OM_D14_MOD <- Merge_master_OM %>%
dplyr::filter(Day %in% 1 & pCO2_history == 'moderate')
pca_res_D14_SEV         <- prcomp(data_normalized_D14_SEV, scale. = TRUE)
pca_res_D14_LOW         <- prcomp(data_normalized_D14_LOW, scale. = TRUE)
Merge_master_OM_D14_LOW <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'low')
pca_res_D14_MOD         <- prcomp(data_normalized_D14_MOD, scale. = TRUE)
Merge_master_OM_D14_MOD <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'moderate')
pca_res_D14_SEV         <- prcomp(data_normalized_D14_SEV, scale. = TRUE)
Merge_master_OM_D14_SEV <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'severe')
ggarrange(
ggbiplot(pca_res_D14_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, low history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14_MOD,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_MOD$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, mod history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
nrow=3)
data_normalized_D14_LOW
pca_res_D14_LOW         <- prcomp(data_normalized_D14_LOW, scale. = TRUE)
Merge_master_OM_D14_LOW <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'low')
pca_res_D14_MOD         <- prcomp(data_normalized_D14_MOD, scale. = TRUE)
Merge_master_OM_D14_MOD <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'moderate')
pca_res_D14_SEV         <- prcomp(data_normalized_D14_SEV, scale. = TRUE)
Merge_master_OM_D14_SEV <- Merge_master_OM %>%
dplyr::filter(Day %in% 14 & pCO2_history == 'severe')
ggbiplot(pca_res_D14_MOD,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_MOD$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, mod history") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggbiplot(pca_res_D14_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
Merge_master_OM_D14_LOW$pCO2_exposure
Merge_master_OM_D14_LOW
Merge_master_OM_D14_SEV$pCO2_exposure
pca_res_D14_LOW
pca_res_D14_SEV
ggbiplot(pca_res_D14_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, low history") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
pca_res_D14_LOW
data_normalized_D14_LOW
Merge_master_OM_D14    <- Merge_master_OM[,as.numeric(c(1,2,3,8,13,18,19))] %>% # call columns , column 1 is Day,
dplyr::filter(Day %in% 14)
numerical_data_D14     <- Merge_master_OM_D14 %>% # call columns , column 1 is Day,
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
head(numerical_data_D14) # lets see it
nrow(numerical_data_D14) # 18
numerical_data_D14_LOW <- Merge_master_OM_D14 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "low") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_MOD <- Merge_master_OM_D14 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "moderate") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_SEV <- Merge_master_OM_D14 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "severe") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
nrow(numerical_data_D14) # 18
data_normalized_D14     <- scale(numerical_data_D14)
data_normalized_D14_LOW <- scale(numerical_data_D14_LOW)
data_normalized_D14_MOD <- scale(numerical_data_D14_MOD)
data_normalized_D14_SEV <- scale(numerical_data_D14_SEV)
corr_matrix_D14     <- cor(data_normalized_D14)
ggcorrplot(corr_matrix_D14)
corr_matrix_D14_LOW <- cor(data_normalized_D14_LOW)
ggcorrplot(corr_matrix_D14_LOW)
corr_matrix_D14_MOD <- cor(data_normalized_D14_MOD)
ggcorrplot(corr_matrix_D14_MOD)
corr_matrix_D14_SEV <- cor(data_normalized_D14_SEV)
ggcorrplot(corr_matrix_D14_SEV)
ggbiplot(pca_res_D14_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggbiplot(pca_res_D1_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.95) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggarrange(
ggbiplot(pca_res_D14_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, low history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14_MOD,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_MOD$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, mod history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
nrow=3)
ggarrange(
ggbiplot(pca_res_D1_LOW,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_LOW$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, low history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1_MOD,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_MOD$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, mod history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1_SEV,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1_SEV$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, sev history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
nrow=3)
pca_res_D1         <- prcomp(data_normalized_D1, scale. = TRUE)
Merge_master_OM_D1 <- Merge_master_OM %>%
dplyr::filter(Day %in% 1)
ggarrange(
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
ggarrange(
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 exposure") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
pca_res_D14         <- prcomp(data_normalized_D14, scale. = TRUE)
Merge_master_OM_D14 <- Merge_master_OM %>%
dplyr::filter(Day %in% 14)
ggarrange(
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 exposure") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
ggarrange(
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, pCO2 exposure") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
ggarrange(
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D14,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D14$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day14, pCO2 exposure") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
ggarrange(
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_history),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 history") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ggbiplot(pca_res_D1,
obs.scale = 1,
var.scale = 1,
size = 5,
groups = as.factor(Merge_master_OM_D1$pCO2_exposure),
ellipse = TRUE,
circle = TRUE) +
scale_color_discrete(name = '') +
theme_classic() +
ggtitle("day1, pCO2 exposure") +
theme(legend.direction = 'horizontal',
legend.position = 'top'),
ncol=2)
