dplyr::arrange(Age)
unique(RR_master_F3$Date)
RR_master <- rbind(RR_master_F1, RR_master_F2, RR_master_F3)
SumTable <- RR_master_F2[!is.na(RR_master_F2$Length_um),] %>%
mutate(Length_mm = Length_um/1000) %>%
summarySE(measurevar="Length_mm", groupvars=c("Date", "Age")) %>%
dplyr::arrange(Age)
SumTable
SumTable_treatment <- RR_master_F2[!is.na(RR_master_F2$Length_um),] %>%
mutate(Length_mm = Length_um/1000) %>%
summarySE(measurevar="Length_mm", groupvars=c("Date", "Age", "pCO2")) %>%
dplyr::arrange(Age)
SumTable_treatment
SumTable <- RR_master_F1[!is.na(RR_master_F1$Length_um),] %>%
mutate(Length_mm = Length_um/1000) %>%
summarySE(measurevar="Length_mm", groupvars=c("Date", "Age")) %>%
dplyr::arrange(Age)
SumTable
SumTable_treatment <- RR_master_F1[!is.na(RR_master_F1$Length_um),] %>%
mutate(Length_mm = Length_um/1000) %>%
summarySE(measurevar="Length_mm", groupvars=c("Date", "Age", "pCO2")) %>%
dplyr::arrange(Age)
SumTable_treatment
RR_master$pCO2 <- factor(RR_master$pCO2, levels = c("500 uatm", "800 uatm", "1200 uatm"))
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# GET B FACTOR FOR ALL AVAILABLE INDIVIDUALS WITH TDW AND MO2 ::::::::::::::::::::::::::::::
RR_master_OM            <- RR_master %>%
filter(!is.na(resp_umol_hr)) %>%
filter(!is.na(Dry_Tissue_weight))
nrow(RR_master_OM) # 140
RR_master_OM$log10_VO2  <- log10(as.numeric(RR_master_OM$resp_umol_hr)) # assign resp value
RR_master_OM$log10_TDW  <- log10(as.numeric(RR_master_OM$Dry_Tissue_weight)) # assign length value
MO2_b.factor_PLOT <- RR_master_OM %>%
ggplot(aes(x=log10_TDW, y=log10_VO2)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_MO2; RR in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Metabolic scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
MO2_b.factor_PLOT_facetted <- RR_master_OM %>%
ggplot(aes(x=log10_TDW, y=log10_VO2, color = pCO2)) +
geom_point() +
scale_color_manual(values=c("blue","orange", "purple")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_MO2; RR in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Metabolic scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left") +
facet_wrap(~pCO2)
# two outliers to remove and rerun below
print(ggarrange(MO2_b.factor_PLOT, MO2_b.factor_PLOT_facetted, nrow = 2, ncol = 1)) # print the model diagnostics
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# GET B FACTOR TWO OUTLIERS OMITTED (VIEW THE PREVIOUS) ::::::::::::::::::::::::::::::
RR_master_OM            <- RR_master %>% filter(!is.na(resp_umol_hr)) %>%  filter(!is.na(Dry_Tissue_weight))
RR_master_OM$log10_VO2  <- log10(as.numeric(RR_master_OM$resp_umol_hr)) # assign resp value
RR_master_OM$log10_TDW  <- log10(as.numeric(RR_master_OM$Dry_Tissue_weight)) # assign length value
# two outliers to remove and rerun below
print(ggarrange(MO2_b.factor_PLOT, MO2_b.factor_PLOT_facetted, nrow = 2, ncol = 1)) # print the model diagnostics
RR_master_OM %>%
dplyr::filter((log10_TDW > -1 & log10_VO2 < 0))
# two outliers to remove and rerun below
print(ggarrange(MO2_b.factor_PLOT, MO2_b.factor_PLOT_facetted, nrow = 2, ncol = 1)) # print the model diagnostics
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < 0.5))
# two outliers to remove and rerun below
print(ggarrange(MO2_b.factor_PLOT, MO2_b.factor_PLOT_facetted, nrow = 2, ncol = 1)) # print the model diagnostics
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < -0.5))
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < -0.7))
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < -0))
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < -02))
RR_master_OM %>% dplyr::filter((log10_TDW > -0.5 & log10_VO2 < -0.2))
MO2_b.factor_PLOT_OM <- RR_master_OM %>%
dplyr::filter(!(log10_TDW > -0.5 & log10_VO2 < -0.2)) %>%  # outliers ommited (should be 2 data points)
ggplot(aes(x=log10_TDW, y=log10_VO2)) +
geom_point() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_MO2; RR in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Metabolic scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left")
MO2_b.factor_PLOT_facetted_OM <- RR_master_OM %>%
dplyr::filter(!(log10_TDW > -0.5 & log10_VO2 < -0.2)) %>%  # outliers ommited (should be 2 data points)
ggplot(aes(x=log10_TDW, y=log10_VO2, color = pCO2)) +
geom_point() +
scale_color_manual(values=c("blue","orange", "purple")) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
scale_x_continuous(name ="log10_BodyMass; TDW in g") +
scale_y_continuous(name ="log10_MO2; RR in umol L-1 hr-1)") +
theme_classic() +
theme(legend.position="none",axis.title.y=element_text(size=7)) +
ggtitle("Metabolic scaling: log10_MO2 = log10_a + (b.factor * log10_BodyMass)") +
geom_smooth(method = lm, color = 'red') +
ggpmisc::stat_poly_eq(parse=T, aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), label.x.npc = "left") +
facet_wrap(~pCO2)
print(ggarrange(MO2_b.factor_PLOT_OM, MO2_b.factor_PLOT_facetted_OM, nrow = 2, ncol = 1)) # print the model diagnostics
# plotting and data edit
library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(tidyr)
library(ggpubr)
# PCA
library(corrr) # correlation analysis
library(ggcorrplot)
library(FactoMineR)
library(factoextra)
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
# contains ATP and total protein in gill tissue
ATP_master      <- read.csv(file="Output/Colorimetric_assays/ATP/ATP_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,mean_TotalProtein_ng,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains MDA and total protein in gill tissue
MDA_master      <- read.csv(file="Output/Colorimetric_assays/MDA/MDA_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains cell vabilty, mitochondrial mem pot, & mtROS in live hemolymph
Flowcy_master <- read.csv(file = "Data/FlowCytometry/Hemolymph_data_filtered.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-X)
nrow(Flowcy_master) # 90 - all samples, full dataset!
Merge_master <- merge( (merge(MDA_master,ATP_master)) ,Flowcy_master)
nrow(Merge_master) # 66 - limited by the ATP dataset for reasons mentioned..
Merge_master_OM <- Merge_master %>% na.omit() # need data for all metrics to run PCA - unfortunately need to omit any NAs
nrow(Merge_master_OM) # 59 - 7 rows ommitted
# day 14 ------------------------------------------------------------------------------------------------ #
colnames(Flowcy_master) # view the col order for the next line..
# desired data includes treatments, day, and the phys measures (live cells, mtROS, mitochondrial membrane potential
# d not call ATP and MDA bcus too many gill tissue samples were lost, missing data reduces a meaningful use of PCA
# dataset for calling treatment downstream
Master_D14    <- Flowcy_master[,as.numeric(c(3:5,9,14,15))] %>% # call columns
dplyr::filter(Day %in% 14)
nrow(Master_D14) # 45 full dataset
Master_D14_OM <- na.omit(Master_D14)
nrow(Master_D14_OM) # 42, droppped 3 rows, not too shabby!
# dataset for PCA - numeric phys data ONLY
# full dataset for day 1
numerical_data_D14     <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
# data by history
numerical_data_D14_LOWhist  <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "low") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_MODhist  <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "moderate") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_HIGHhist <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "severe") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
# data by exposure
numerical_data_D14_LOWexp  <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "low") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_MODexp  <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "moderate") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D14_HIGHexp <- Master_D14_OM %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "severe") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
# day 14 ------------------------------------------------------------------------------------------------ #
corr_matrix_D14     <- cor(data_normalized_D14)
# day 14 ------------------------------------------------------------------------------------------------ #
data_normalized_D14     <- scale(numerical_data_D14)
# by history
data_normalized_D14_LOWhist  <- scale(numerical_data_D14_LOWhist)
data_normalized_D14_MODhist  <- scale(numerical_data_D14_MODhist)
data_normalized_D14_HIGHhist <- scale(numerical_data_D14_HIGHhist)
# by exposure
data_normalized_D14_LOWexp   <- scale(numerical_data_D14_LOWexp)
data_normalized_D14_MODexp   <- scale(numerical_data_D14_MODexp)
data_normalized_D14_HIGHexp  <- scale(numerical_data_D14_HIGHexp)
# day 14 ------------------------------------------------------------------------------------------------ #
corr_matrix_D14     <- cor(data_normalized_D14)
ggcorrplot(corr_matrix_D14)
# by history
corr_matrix_D14_LOWhist <- cor(data_normalized_D14_LOWhist)
ggcorrplot(corr_matrix_D14_LOWhist)
corr_matrix_D14_MODhist <- cor(data_normalized_D14_MODhist)
ggcorrplot(corr_matrix_D14_MODhist)
corr_matrix_D14_HIGHhist <- cor(data_normalized_D14_HIGHhist)
ggcorrplot(corr_matrix_D14_HIGHhist)
# by exposure
corr_matrix_D14_LOWexp <- cor(data_normalized_D14_LOWexp)
ggcorrplot(corr_matrix_D14_LOWexp)
corr_matrix_D14_MODexp <- cor(data_normalized_D14_MODexp)
ggcorrplot(corr_matrix_D14_MODexp)
corr_matrix_D14_HIGHexp <- cor(data_normalized_D14_HIGHexp)
ggcorrplot(corr_matrix_D14_HIGHexp)
# each component explains a percentage of the total variance
# in the data - the Cumulative Proportion section first PC is 53%  of the total var
# this implies that ~1/2 of the data in the set of 4 variables is represented by the first PC
# day 14 ------------------------------------------------------------------------------------------------ #
data.pca_D14 <- princomp(corr_matrix_D14)
summary(data.pca_D14)
# Importance of components:
#                           Comp.1    Comp.2       Comp.3
# Standard deviation     0.9109037 0.4481446 9.231341e-09
# Proportion of Variance 0.8051255 0.1948745 8.268909e-17
# Cumulative Proportion  0.8051255 1.0000000 1.000000e+00
# by history
data.pca_D14_LOWexp  <- princomp(corr_matrix_D14_LOWexp)
data.pca_D14_MODexp  <- princomp(corr_matrix_D14_MODexp)
data.pca_D14_HIGHexp <- princomp(corr_matrix_D14_HIGHexp)
summary(data.pca_D14_LOWexp)
# Importance of components:
#                           Comp.1    Comp.2       Comp.3
# Standard deviation     0.9505194 0.3742350 9.932888e-09
# Proportion of Variance 0.8657915 0.1342085 9.454584e-17
# Cumulative Proportion  0.8657915 1.0000000 1.000000e+00
summary(data.pca_D14_MODexp)
# Importance of components:
#                           Comp.1    Comp.2       Comp.3
# Standard deviation     0.9313134 0.4933215 3.650024e-08
# Proportion of Variance 0.7808916 0.2191084 1.199473e-15
# Cumulative Proportion  0.7808916 1.0000000 1.000000e+00
summary(data.pca_D14_HIGHexp)
# Importance of components:
#                           Comp.1    Comp.2       Comp.3
# Standard deviation     0.6639862 0.4908829 1.825012e-08
# Proportion of Variance 0.6465963 0.3534037 4.884799e-16
# Cumulative Proportion  0.6465963 1.0000000 1.000000e+00
# by exposure
data.pca_D14_LOWhist  <- princomp(corr_matrix_D14_LOWhist)
data.pca_D14_MODhist  <- princomp(corr_matrix_D14_MODhist)
data.pca_D14_HIGHhist <- princomp(corr_matrix_D14_HIGHhist)
summary(data.pca_D14_LOWhist)
# Importance of components:
#                           Comp.1    Comp.2       Comp.3
# Standard deviation     1.0395475 0.3599469 1.418548e-08
# Proportion of Variance 0.8929437 0.1070563 1.662737e-16
# Cumulative Proportion  0.8929437 1.0000000 1.000000e+00
summary(data.pca_D14_MODhist)
# Importance of components:
#                           Comp.1    Comp.2 Comp.3
# Standard deviation     0.6803953 0.6023649      0
# Proportion of Variance 0.5606058 0.4393942      0
# Cumulative Proportion  0.5606058 1.0000000      1
summary(data.pca_D14_HIGHhist)
# Importance of components:
#                           Comp.1     Comp.2       Comp.3
# Standard deviation     0.9835123 0.19438590 3.731209e-09
# Proportion of Variance 0.9624052 0.03759481 1.385152e-17
# Cumulative Proportion  0.9624052 1.00000000 1.000000e+00
fviz_pca_var(data.pca_D14, col.var = "cos2",
gradient.cols = c("green", "orange", "red"),
repel = TRUE)
pca_res_D14       <- prcomp(data_normalized_D14, scale. = TRUE)
Merge_master_D14  <- Master_D14_OM %>% dplyr::mutate(pCO2_all = paste0(pCO2_history, " x ", pCO2_exposure))
# vars for plotting
cols = c('#009E73','#009E73','#009E73',
'#E69F00','#E69F00','#E69F00',
'#CC79A7','#CC79A7','#CC79A7')
shapes = c(16, 15, 17,
16, 15, 17,
16, 15, 17)
PCAbiplot_D14         <- fviz_pca_biplot(pca_res_D14,
label="var",
habillage=Merge_master_D14$pCO2_all) +
ggforce::geom_mark_ellipse(aes(fill = Groups, color = Groups)) +
scale_fill_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols)+
scale_colour_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols) +
scale_fill_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols)+
scale_shape_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = shapes) +
theme_bw() +
xlim(-4, 4) + ylim (-4, 4) +
theme(legend.position = 'bottom') +
ggtitle("Day 14") +
coord_equal()
PCAbiplot_D14_history <- fviz_pca_biplot(pca_res_D14,
label="var",
habillage=Merge_master_D14$pCO2_history,
palette = c("#009E73","#E69F00", "#CC79A7")) +
ggforce::geom_mark_ellipse(aes(fill = Groups, color = Groups)) +
theme_bw() +
scale_shape_manual(breaks = unique(Merge_master_D14$pCO2_history),
values = c(16, 15, 17)) +
xlim(-4, 4) + ylim (-4, 4) +
theme(legend.position = 'bottom') +
ggtitle("Day 14: by history") +
coord_equal()
pdf("Output/D14_PCA_hemolymph.pdf", height=5, width=20)
pdf("Output/D14_PCA_hemolymph.pdf", height=5, width=20)
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
ggarrange(PCAbiplot_D14,
PCAbiplot_D14_exp,
PCAbiplot_D14_history, nrow=1, ncol=3)
PCAbiplot_D14         <- fviz_pca_biplot(pca_res_D14,
label="var",
habillage=Merge_master_D14$pCO2_all) +
ggforce::geom_mark_ellipse(aes(fill = Groups, color = Groups)) +
scale_fill_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols)+
scale_colour_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols) +
scale_fill_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = cols)+
scale_shape_manual(breaks = unique(Merge_master_D14$pCO2_all),
values = shapes) +
theme_bw() +
xlim(-4, 4) + ylim (-4, 4) +
theme(legend.position = 'bottom') +
ggtitle("Day 14") +
coord_equal()
PCAbiplot_D14_exp     <- fviz_pca_biplot(pca_res_D14,
label="var",
habillage=Merge_master_D14$pCO2_exposure,
palette = c("#009E73","#E69F00", "#CC79A7")) +
ggforce::geom_mark_ellipse(aes(fill = Groups, color = Groups)) +
theme_bw() +
scale_shape_manual(breaks = unique(Merge_master_D14$pCO2_exposure),
values = c(16, 15, 17)) +
xlim(-4, 4) + ylim (-4, 4) +
theme(legend.position = 'bottom') +
ggtitle("Day 14: by exposure") +
coord_equal()
PCAbiplot_D14_history <- fviz_pca_biplot(pca_res_D14,
label="var",
habillage=Merge_master_D14$pCO2_history,
palette = c("#009E73","#E69F00", "#CC79A7")) +
ggforce::geom_mark_ellipse(aes(fill = Groups, color = Groups)) +
theme_bw() +
scale_shape_manual(breaks = unique(Merge_master_D14$pCO2_history),
values = c(16, 15, 17)) +
xlim(-4, 4) + ylim (-4, 4) +
theme(legend.position = 'bottom') +
ggtitle("Day 14: by history") +
coord_equal()
ggarrange(PCAbiplot_D14,
PCAbiplot_D14_exp,
PCAbiplot_D14_history, nrow=1, ncol=3)
# save plot
pdf("Output/D14_PCA_hemolymph.pdf", height=5, width=20)
ggarrange(PCAbiplot_D14,
PCAbiplot_D14_exp,
PCAbiplot_D14_history, nrow=1, ncol=3)
dev.off()
# plotting and data edit
library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(tidyr)
library(ggpubr)
# PCA
library(corrr) # correlation analysis
library(ggcorrplot)
library(FactoMineR)
library(factoextra)
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
# contains ATP and total protein in gill tissue
ATP_master      <- read.csv(file="Output/Colorimetric_assays/ATP/ATP_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,mean_TotalProtein_ng,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains MDA and total protein in gill tissue
MDA_master      <- read.csv(file="Output/Colorimetric_assays/MDA/MDA_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains cell vabilty, mitochondrial mem pot, & mtROS in live hemolymph
Flowcy_master <- read.csv(file = "Data/FlowCytometry/Hemolymph_data_filtered.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-X)
nrow(Flowcy_master) # 90 - all samples, full dataset!
Merge_master <- merge( (merge(MDA_master,ATP_master)) ,Flowcy_master)
nrow(Merge_master) # 66 - limited by the ATP dataset for reasons mentioned..
Merge_master_OM <- Merge_master %>% na.omit() # need data for all metrics to run PCA - unfortunately need to omit any NAs
nrow(Merge_master_OM) # 59 - 7 rows ommitted
# day 1 ------------------------------------------------------------------------------------------------ #
colnames(Merge_master_OM) # view the col order for the next line..
Merge_master_OM_D1    <- Merge_master_OM[,as.numeric(c(1:3,6,8,13,18,19))] %>% # call columns , column 1 is Day,
dplyr::filter(Day %in% 1)
colnames(Merge_master_OM_D1) # lookin' good!
# full dataset for day 1
numerical_data_D1     <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
# data by history
numerical_data_D1_LOWhist  <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "low") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D1_MODhist  <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "moderate") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D1_HIGHhist <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_history == "severe") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
# data by exposure
numerical_data_D1_LOWexp  <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "low") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D1_MODexp  <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "moderate") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
numerical_data_D1_HIGHexp <- Merge_master_OM_D1 %>% # call columns , column 1 is Day,
dplyr::filter(pCO2_exposure == "severe") %>% # filter by exposure
dplyr::select(-c(Day,pCO2_history, pCO2_exposure)) #omit columns
Merge_master_OM_D1
# save it out
write.csv(Merge_master_OM_D1, "Output/Day1_All_Phys_noNA.csv")
# save it out
write.csv(Merge_master_OM_D1, "/Output/Day1_All_Phys_noNA.csv")
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
# save it out
write.csv(Merge_master_OM_D1, "/Output/Day1_All_Phys_noNA.csv")
# save it out
write.csv(Merge_master_OM_D1, "/Output/Day1_All_Phys_noNA.csv",, row.names=FALSE)
# save it out
write.csv(Merge_master_OM_D1, "/Output/Day1_All_Phys_noNA.csv", row.names=FALSE)
Merge_master_OM_D1
write.csv(Merge_master_OM_D1, "/Output/D1_All_Phys_noNA.csv", row.names=FALSE)
# save it out
write.csv(Merge_master_OM_D1, "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis/Output/D1_All_Phys_noNA.csv", row.names=FALSE)
# day 1 ------------------------------------------------------------------------------------------------ #
colnames(Flowcy_master) # view the col order for the next line..
Subset_master_D1    <- Flowcy_master[,as.numeric(c(3:5,9,14,15))] %>% # call columns
dplyr::filter(Day %in% 1)
nrow(Subset_master_D1) # 45 full dataset
Subset_master_D1_OM <- na.omit(Subset_master_D1)
nrow(Subset_master_D1_OM) # 40, dropped 5 rows, not too shabby!
Subset_master_D1_OM
# day 14 ------------------------------------------------------------------------------------------------ #
colnames(Flowcy_master) # view the col order for the next line..
Master_D14    <- Flowcy_master[,as.numeric(c(3:5,9,14,15))] %>% # call columns
dplyr::filter(Day %in% 14)
nrow(Master_D14) # 45 full dataset
Master_D14_OM <- na.omit(Master_D14)
nrow(Master_D14_OM) # 42, droppped 3 rows, not too shabby!
nrow(Master_D14) # 45 full dataset
Master_D14_OM
write.csv(Master_D14_OM, "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis/Output/D14_All_Phys_noNA.csv", row.names=FALSE)
# plotting and data edit
library(ggplot2)
library(dplyr)
library(tidyverse)
library(car)
library(tidyr)
library(ggpubr)
# PCA
library(corrr) # correlation analysis
library(ggcorrplot)
library(FactoMineR)
library(factoextra)
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis") # sets the working directory for the entire R markdown file - no need to reload the wd
# contains ATP and total protein in gill tissue
ATP_master      <- read.csv(file="Output/Colorimetric_assays/ATP/ATP_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,mean_TotalProtein_ng,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains MDA and total protein in gill tissue
MDA_master      <- read.csv(file="Output/Colorimetric_assays/MDA/MDA_Master.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-c(mean_TotalProtein_ug,X))
nrow(ATP_master) # 65 - remember quite a few samples lost at the bottom of the dewar for D14!
# contains cell vabilty, mitochondrial mem pot, & mtROS in live hemolymph
Flowcy_master <- read.csv(file = "Data/FlowCytometry/Hemolymph_data_filtered.csv",
sep = ",",
header=TRUE) %>% dplyr::select(-X)
nrow(Flowcy_master) # 90 - all samples, full dataset!
Merge_master <- merge( (merge(MDA_master,ATP_master)) ,Flowcy_master)
nrow(Merge_master) # 66 - limited by the ATP dataset for reasons mentioned..
Merge_master_OM <- Merge_master %>% na.omit() # need data for all metrics to run PCA - unfortunately need to omit any NAs
nrow(Merge_master_OM) # 59 - 7 rows ommitted
# day 1 ------------------------------------------------------------------------------------------------ #
colnames(Merge_master_OM) # view the col order for the next line..
# desired data includes treatments, day, and the phys measures (live cells, mtROS, mitochondrial membrane potential, ATP and MDA
# dataset for calling tretament downstream
Master_D1    <- Merge_master[,as.numeric(c(1:3,6,8,13,18,19))] %>% # call columns , column 1 is Day,
dplyr::filter(Day %in% 1)
nrow(Master_D1) # 46
Master_D1_OM <- na.omit(Master_D1)
colnames(Master_D1_OM) # lookin' good!
head(Master_D1_OM) # lets have a gander
nrow(Master_D1_OM)
# save it out
write.csv(Master_D1_OM, "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis/Output/D1_All_Phys_noNA.csv", row.names=FALSE)
# day 1 ------------------------------------------------------------------------------------------------ #
colnames(Flowcy_master) # view the col order for the next line..
# desired data includes treatments, day, and the phys measures (live cells, mtROS, mitochondrial membrane potential
# d not call ATP and MDA bcus we want to pursue a meaningful comparison to the day 14 data (too many missing samples for dewar eror!)
# dataset for calling tretament downstream
Subset_master_D1    <- Flowcy_master[,as.numeric(c(3:5,9,14,15))] %>% # call columns
dplyr::filter(Day %in% 1)
nrow(Subset_master_D1) # 45 full dataset
Subset_master_D1_OM <- na.omit(Subset_master_D1)
nrow(Subset_master_D1_OM) # 40, dropped 5 rows, not too shabby!
# day 14 ------------------------------------------------------------------------------------------------ #
colnames(Flowcy_master) # view the col order for the next line..
# desired data includes treatments, day, and the phys measures (live cells, mtROS, mitochondrial membrane potential
# d not call ATP and MDA bcus too many gill tissue samples were lost, missing data reduces a meaningful use of PCA
# dataset for calling treatment downstream
Master_D14    <- Flowcy_master[,as.numeric(c(3:5,9,14,15))] %>% # call columns
dplyr::filter(Day %in% 14)
nrow(Master_D14) # 45 full dataset
Master_D14_OM <- na.omit(Master_D14)
nrow(Master_D14_OM) # 42, droppped 3 rows, not too shabby!
# save it out
write.csv(Master_D14_OM, "C:/Users/samjg/Documents/Github_repositories/Airradians_CellularMolecular_OA/RAnalysis/Output/D14_All_Phys_noNA.csv", row.names=FALSE)
